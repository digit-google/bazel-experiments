Abstract:
---------

A third example that demonstrate how to build PIE-optimized ELF executables
and PIC-optimized ELF shared libraries in a single build invocation.
Where the common library sources are generated by a genrule().

Compared to the third example, this symlinks the genrule() outputs to their
identical output location, relative to the dependent's build configuration,
which allows `#include <src/common.h>` to work properly in dependents of
the `common` library.


Testing:
------

Run the `run_tests.sh` in the workspace directory.

Implementation Note:
--------------------

The change is in the implementation of unique_genrule() which will now ensure
that symlinks are created for all outputs of the genrule().


Issues / Unknowns / Future Work:
--------------------------------

If the dependent of the `unique_genrule()` target is already  in the
"unique" build configuration, symlink creation will fail, i.e.:

```sh
$ bazel build //src:common
ERROR: file 'src/common.h' is generated by these conflicting actions:
Label: //src:generate_common.genrule, //src:generate_common
RuleClass: genrule rule, _wrap_unique_genrule rule
Configuration: 6167a43bee81d7c4ceebdf8986e0027b728c609e76e2c99eb3032efb76afa9e5
Mnemonic: Genrule, Symlink
Action key: bea42f16cc513106d88e8f88f0739b713931b9efa6879cbd42f015a9d0d5e4d1, d7773cd91ffd7932031eb8962471d065e41bfad384f2ed5d8d1925666f92ac3f
Progress message: Generating common library sources //src:generate_common.genrule, Creating symlink bazel-out/k8-fastbuild/bin/src/common.h
PrimaryInput: File:[/work2/github-digit/bazel-experiments/pic-vs-pie/transitions-4[source]]src/generate_common_lib.sh, File:[[<execution_root>]bazel-out/k8-fastbuild/bin]src/common.h
PrimaryOutput: File:[[<execution_root>]bazel-out/k8-fastbuild/bin]src/common.h
ERROR: com.google.devtools.build.lib.skyframe.ArtifactConflictFinder$ConflictException: com.google.devtools.build.lib.actions.MutableActionGraph$ActionConflictException: for src/common.h, previous action: action 'Creating symlink bazel-out/k8-fastbuild/bin/src/common.h', attempted action: action 'Generating common library sources //src:generate_common.genrule'
INFO: Elapsed time: 0.269s
INFO: 0 processes.
FAILED: Build did NOT complete successfully (1 packages loaded, 144 targets configured)
```
